# 用户注册接口文档

## 一、接口概述

本文档描述了用户注册相关的API接口，包括发送验证码和验证验证码完成注册两个步骤。

### 基本信息

| 项目             | 内容                           |
| ---------------- | ------------------------------ |
| **Base URL**     | `http://localhost:8080/api`    |
| **Content-Type** | `application/json`             |
| **字符编码**     | `UTF-8`                        |

## 二、接口详情

### 2.1 用户注册第一步：发送验证码

#### 基本信息

- **接口标识**：`AUTH_REGISTER_STEP1`
- **请求路径**：`POST /auth/register/step1`
- **接口描述**：用户提供邮箱和密码，系统发送验证码到用户邮箱
- **认证要求**：无需认证（公开接口）

#### 请求参数

```json
{
  "email": "user@example.com",
  "password": "Password123"
}
```

#### 参数说明

| 参数名    | 类型   | 必填 | 说明                                     |
| --------- | ------ | ---- | ---------------------------------------- |
| email     | string | 是   | 用户邮箱，需符合标准格式（如xxx@xx.com） |
| password  | string | 是   | 密码，长度不少于8位                      |

#### 响应示例

##### 成功响应（状态码 200）

```json
{
  "code": 200,
  "message": "验证码已发送至您的邮箱，请查收",
  "data": null,
  "timestamp": "2025-08-11T02:39:14.096152"
}
```

##### 失败响应

- **邮箱为空（400）**

```json
{
  "code": 400,
  "message": "邮箱不能为空",
  "data": null,
  "timestamp": "2025-08-11T10:30:00Z"
}
```

- **密码为空（400）**

```json
{
  "code": 400,
  "message": "密码不能为空",
  "data": null,
  "timestamp": "2025-08-11T10:31:00Z"
}
```

- **密码长度不足（400）**

```json
{
  "code": 400,
  "message": "密码长度不能少于8位",
  "data": null,
  "timestamp": "2025-08-11T10:32:00Z"
}
```

- **邮箱已被注册（409）**

```json
{
  "code": 409,
  "message": "该邮箱已被注册",
  "data": null,
  "timestamp": "2025-08-11T10:33:00Z"
}
```

- **验证码发送失败（500）**

```json
{
  "code": 500,
  "message": "验证码发送失败，请稍后重试",
  "data": null,
  "timestamp": "2025-08-11T10:34:00Z"
}
```

### 2.2 用户注册第二步：验证验证码并完成注册

#### 基本信息

- **接口标识**：`AUTH_REGISTER_STEP2`
- **请求路径**：`POST /auth/register/step2`
- **接口描述**：用户提供邮箱、密码和验证码，系统验证后完成注册
- **认证要求**：无需认证（公开接口）

#### 请求参数

```json
{
  "email": "user@example.com",
  "password": "Password123",
  "code": "123456"
}
```

#### 参数说明

| 参数名    | 类型   | 必填 | 说明                                     |
| --------- | ------ | ---- | ---------------------------------------- |
| email     | string | 是   | 用户邮箱，需与第一步相同                 |
| password  | string | 是   | 密码，需与第一步相同                     |
| code      | string | 是   | 收到的验证码                             |

#### 响应示例

##### 成功响应（状态码 200）

```json
{
  "code": 200,
  "message": "注册成功",
  "data": {
    "id": 3,
    "username": "test",
    "password": null,
    "email": "test@example.com"
  },
  "timestamp": "2025-08-11T02:39:28.585142"
}
```

##### 失败响应

- **邮箱为空（400）**

```json
{
  "code": 400,
  "message": "邮箱不能为空",
  "data": null,
  "timestamp": "2025-08-11T10:40:00Z"
}
```

- **密码为空（400）**

```json
{
  "code": 400,
  "message": "密码不能为空",
  "data": null,
  "timestamp": "2025-08-11T10:41:00Z"
}
```

- **验证码为空（400）**

```json
{
  "code": 400,
  "message": "验证码不能为空",
  "data": null,
  "timestamp": "2025-08-11T10:42:00Z"
}
```

- **验证码无效或已过期（400）**

```json
{
  "code": 400,
  "message": "注册失败，验证码无效或已过期",
  "data": null,
  "timestamp": "2025-08-11T10:43:00Z"
}
```

## 三、测试用例

### 3.1 注册第一步测试

```bash
curl -X POST http://localhost:8084/api/auth/register/step1 \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"Test1234"}'
```

### 3.2 注册第二步测试

```bash
curl -X POST http://localhost:8084/api/auth/register/step2 \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"Test1234","code":"338310"}'
```

## 四、注意事项

1. 验证码有效期为10分钟，超时需重新获取
2. 密码必须至少8位
3. 同一邮箱在短时间内（1分钟）只能请求一次验证码
4. 注册成功后返回的用户信息中，密码字段会被设置为null，保护用户隐私